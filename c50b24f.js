(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{1098:function(t,e,n){"use strict";n(13),n(39),n(33),n(529),n(246);e.a={upload:function(t,e,n){var o=n.format,l=n.metaData;return new Promise((function(n,c){var r=new FormData;r.append("image",e),t.$axios.post("/upload_image",r,{api_type:0,params:{format:o||"webp"}}).then((function(t){var e=new URL(t.data.data,"https://dc-api.okmiku.com"),image=new Image;image.src=e,image.onload=function(){n(l?{url:e,e:t}:e)},image.onerror=function(){c(t)}})).catch(c)}))}}},1511:function(t,e,n){t.exports={}},1512:function(t,e,n){t.exports={}},2857:function(t,e,n){"use strict";n(1511)},2858:function(t,e,n){"use strict";n(1512)},2943:function(t,e,n){"use strict";n.r(e);n(59),n(21),n(68);var o=n(1098),l={name:"SetBackground",data:function(){return{upload:{n:"",uploadData:null,file:"",loading:!1}}},computed:{$bg:function(){return this.$store.state.setting.bg}},methods:{handleChange:function(t,e){this.$store.commit("SET_STORE",{key:"setting.bg.".concat(t),value:e})},handleUploadChange:function(t){var e=t.target.files;if(!e.length)return!1;var n=e[0];n.size/1024/1024>5?(this.upload.n="",this.$notify.error({title:"上传失败",message:"请选择大小在5M以内的图片"})):this.upload.file=n},uploadImg:function(){var t=this;return!!this.upload.file&&(!this.upload.loading&&(this.upload.uploadData=null,this.upload.loading=!0,void o.a.upload(this,this.upload.file,{format:"webp"}).then((function(e){t.upload.uploadData=e,t.setUploadBg()})).catch((function(e){t.$notify.error({title:"上传失败",message:e}),t.upload.loading=!1}))))},setUploadBg:function(){this.$store.commit("SET_STORE",{key:"setting.bg.upload",value:this.upload.uploadData}),this.upload.loading=!1},removeBg:function(){this.$store.commit("SET_STORE",{key:"setting.bg.upload",value:{url:""}}),this.upload.uploadData=null}}},c=(n(2857),n(6)),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("nya-container",{staticClass:"set-bg",attrs:{title:"背景图片"}},[e("div",{staticClass:"radio-group mb-15"},[e("el-select",{staticClass:"full-width",on:{change:function(e){return t.handleChange("type",e)}},model:{value:t.$bg.type,callback:function(e){t.$set(t.$bg,"type",e)},expression:"$bg.type"}},[e("el-option",{attrs:{label:"无",value:"none"}}),e("el-option",{attrs:{label:"随机动漫图片",value:"anime"}}),e("el-option",{attrs:{label:"必应每日壁纸",value:"bing"}}),e("el-option",{attrs:{label:"自定义来源",value:"custom"}})],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"custom"===t.$bg.type,expression:"$bg.type === 'custom'"}],staticClass:"mb-15"},[e("div",{staticClass:"nya-subtitle"},[t._v("\n            输入壁纸链接\n        ")]),e("el-input",{attrs:{placeholder:"".concat(t.$store.state.env.url,"/icon.png"),clearable:""},on:{change:function(e){return t.handleChange("customUrl",e.target.value)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleChange("customUrl",e.target.value)}},model:{value:t.$bg.customUrl,callback:function(e){t.$set(t.$bg,"customUrl",e)},expression:"$bg.customUrl"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"upload"===t.$bg.type,expression:"$bg.type === 'upload'"}]},[e("el-input",{staticClass:"mt-15",attrs:{type:"file",accept:"image/*",disabled:t.upload.loading,placeholder:t.upload.n?t.upload.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件",clearable:""},on:{clear:function(e){t.upload.file=null}},nativeOn:{change:function(e){return t.handleUploadChange.apply(null,arguments)}},model:{value:t.upload.n,callback:function(e){t.$set(t.upload,"n",e)},expression:"upload.n"}},[e("el-button",{attrs:{slot:"append",loading:t.upload.loading},on:{click:t.uploadImg},slot:"append"},[t._v("\n                "+t._s(t.upload.loading?"设置中":"设置")+"\n            ")])],1),t.upload.uploadData&&t.upload.uploadData.url?e("div",[e("div",{staticClass:"nya-subtitle"},[t._v("\n                预览(当前背景)\n            ")]),e("img",{staticClass:"preview mb-15",attrs:{src:t.upload.uploadData.url,alt:"preview"}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.$bg.upload.url,expression:"$bg.upload.url"}],on:{click:t.removeBg}},[t._v("\n                移除背景\n            ")])],1):t._e()],1),e("div",{staticClass:"mb-15"},[e("div",{staticClass:"nya-subtitle inline-title"},[t._v("\n            元素半透明\n        ")]),e("el-switch",{on:{change:function(e){return t.handleChange("transparentEl",e)}},model:{value:t.$bg.transparentEl,callback:function(e){t.$set(t.$bg,"transparentEl",e)},expression:"$bg.transparentEl"}})],1),e("div",{staticClass:"mb-15"},[e("div",{staticClass:"nya-subtitle mb-0"},[t._v("\n            高斯模糊\n        ")]),e("el-slider",{attrs:{min:0,max:100},on:{change:function(e){return t.handleChange("blur",e)}},model:{value:t.$bg.blur,callback:function(e){t.$set(t.$bg,"blur",e)},expression:"$bg.blur"}})],1),e("div",[e("div",{staticClass:"nya-subtitle mb-0 mt-0"},[t._v("\n            透明度\n        ")]),e("el-slider",{attrs:{min:1,max:100},on:{change:function(e){return t.handleChange("opacity",e)}},model:{value:t.$bg.opacity,callback:function(e){t.$set(t.$bg,"opacity",e)},expression:"$bg.opacity"}})],1)])}),[],!1,null,null,null),r=component.exports,d=n(47),m=n.n(d),h={name:"Setting",components:{SetBackground:r},data:function(){return{setting:null}},mounted:function(){var t=this;setTimeout((function(){t.setting=t.$store.state.setting}),0)},methods:{handleChange:function(t,e){this.$message.success("更新成功，部分设置需要刷新或重启 APP 后生效"),this.$store.commit("SET_STORE",{key:t,value:e})},formatDate:function(t){return 0===t?"未同步过":m.a.unix(t).format("MM-DD HH:mm:ss")},clearData:function(){var t=this;this.$alert("是否清除网站所有数据","重置设置",{confirmButtonText:"确定"}).then((function(){localStorage.removeItem("miku_vuex"),localStorage.removeItem("mikudb"),t.$store.state.env.isWeb?(t.$store.commit("clearCache"),t.$notify.success({title:"清除成功",message:"即将自动刷新页面"}),setTimeout((function(){window.location.reload(!0)}),2e3)):t.$notify.success({title:"清除成功",message:"重启 APP 后生效"})})).catch((function(){}))}}},f=(n(2858),function(t){t.exports.head={meta:[{hid:"description",description:"设置壁纸等内容"}],title:"网站设置 - MikuTools"},t.options.toolsMeta={name:"网站设置",path:"/setting",head:{meta:[{hid:"description",description:"设置壁纸等内容"}],title:"网站设置 - MikuTools"},hot:"recommend",vip:!1,platforms:["app-android","web-pc","web-mobile"],key:"mikutools",icon:"$tabler$settings"}}),v=Object(c.a)(h,(function(){var t=this,e=t._self._c;return t.setting?e("div",{staticClass:"setting"},[e("SetBackground"),e("nya-container",{attrs:{title:"其他设置"}},[e("div",[e("el-checkbox",{on:{change:function(e){return t.handleChange("setting.autoDarkMode",e)}},model:{value:t.setting.autoDarkMode,callback:function(e){t.$set(t.setting,"autoDarkMode",e)},expression:"setting.autoDarkMode"}},[t._v("\n                自动切换夜间模式\n            ")]),this.$store.state.isMobile?e("el-checkbox",{on:{change:function(e){return t.handleChange("setting.showConsole",e)}},model:{value:t.setting.showConsole,callback:function(e){t.$set(t.setting,"showConsole",e)},expression:"setting.showConsole"}},[t._v("\n                移动端显示 Console\n            ")]):t._e(),t.$store.state.env.isApp?t._e():e("el-checkbox",{on:{change:function(e){return t.handleChange("setting.inNewTab",e)}},model:{value:t.setting.inNewTab,callback:function(e){t.$set(t.setting,"inNewTab",e)},expression:"setting.inNewTab"}},[t._v("\n                新标签打开工具\n            ")])],1),t.$store.state.env.isWeb?e("el-button",{staticClass:"mt-15",on:{click:t.clearData}},[t._v("\n            清除网站数据\n        ")]):t._e()],1)],1):t._e()}),[],!1,null,null,null);"function"==typeof f&&f(v);e.default=v.exports}}]);