(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{1098:function(e,t,n){"use strict";n(13),n(39),n(33),n(529),n(246);t.a={upload:function(e,t,n){var o=n.format,r=n.metaData;return new Promise((function(n,l){var c=new FormData;c.append("image",t),e.$axios.post("/upload_image",c,{api_type:0,params:{format:o||"webp"}}).then((function(e){var t=new URL(e.data.data,"https://dc-api.okmiku.com"),image=new Image;image.src=t,image.onload=function(){n(r?{url:t,e:e}:t)},image.onerror=function(){l(e)}})).catch(l)}))}}},1510:function(e,t,n){e.exports={}},2856:function(e,t,n){"use strict";n(1510)},3055:function(e,t,n){"use strict";n.r(t);n(21),n(68);var o=n(959),r=n(1098),l={name:"SearchPic",data:function(){return{n:"",file:null,data:[],preview:null,loading:!1,loadingText:"上传中···",uploadData:null,apiType:"saucenao"}},methods:{handleChange:function(e){var t=this,n=e.target.files;if(!n.length)return!1;var r=n[0];r.size/1024/1024>5?(this.n="",this.$notify.error({title:"识别失败",message:"请选择大小在5M以内的图片"})):(this.data=[],this.preview=null,Object(o.a)(r).then((function(e){t.preview=e})),this.file=r)},start:function(){var e=this;return!!this.file&&(!this.loading&&(this.data=[],this.loading=!0,void r.a.upload(this,this.file,{format:"webp",useCdn:!1}).then((function(t){e.searchPic(t)})).catch((function(t){e.$notify.error({title:"上传图片失败",message:t}),e.loading=!1}))))},searchPic:function(e){var t=this;if(this.loadingText="上传中···",!e)return this.loading=!1,this.$notify.error({title:"上传图片失败",message:"err"});this.$axios.post("/search_pic",{url:e,apiType:this.apiType}).then((function(e){t.data=e.data.data,t.loading=!1})).catch((function(e){t.$notify.error({title:"上传图片失败",message:e}),t.loading=!1}))}}},c=(n(2856),n(6)),d=function(e){e.exports.head={meta:[{hid:"keywords",keywords:"以图搜图,pixiv图片搜索,SauceNAO,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"动漫图片找出处"}],title:"以图搜图 - MikuTools"},e.options.toolsMeta={name:"以图搜图",path:"/search_pic",head:{meta:[{hid:"keywords",keywords:"以图搜图,pixiv图片搜索,SauceNAO,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"动漫图片找出处"}],title:"以图搜图 - MikuTools"},hot:"hot",vip:!1,platforms:["app-android","web-pc","web-mobile"],key:["image","hot"],icon:"$tabler$photo-search"}},component=Object(c.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search_pic"},[t("nya-container",{attrs:{main:"",title:"以图搜图"}},[t("div",{staticClass:"nya-subtitle mt-0"},[e._v("\n            请选择要识别 ACG 图片\n        ")]),t("el-input",{attrs:{type:"file",accept:"image/*",disabled:e.loading,placeholder:e.n?e.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件"},nativeOn:{change:function(t){return e.handleChange.apply(null,arguments)}},model:{value:e.n,callback:function(t){e.n=t},expression:"n"}},[t("el-button",{attrs:{slot:"append",loading:e.loading},on:{click:e.start},slot:"append"},[e._v("\n                "+e._s(e.loading?e.loadingText:"开始获取")+"\n            ")])],1),t("div",{staticClass:"mt-15"},[t("span",[e._v("选择接口：")]),t("el-radio",{attrs:{label:"iqdb"},model:{value:e.apiType,callback:function(t){e.apiType=t},expression:"apiType"}},[e._v("\n                IQDB\n            ")]),t("el-radio",{attrs:{label:"saucenao"},model:{value:e.apiType,callback:function(t){e.apiType=t},expression:"apiType"}},[e._v("\n                SauceNAO\n            ")])],1),e.preview?t("div",{staticClass:"nya-subtitle"},[e._v("\n            预览\n        ")]):e._e(),e.preview?t("img",{staticClass:"preview",attrs:{src:e.preview,alt:"preview"}}):e._e()],1),e.data.length?t("nya-container",{attrs:{title:"获取成功"}},e._l(e.data,(function(n,o){return t("div",{key:o,staticClass:"imginfo"},[t("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.$store.state.env.imageServer+encodeURIComponent(n.thumbnail),expression:"$store.state.env.imageServer + encodeURIComponent(item.thumbnail)"}]}),t("div",[e._v("\n                链接："),t("app-link",{attrs:{href:n.url,target:"_blank",rel:"noopener noreferrer"}},[e._v("\n                    "+e._s(n.url)+"\n                ")])],1),n.title?t("div",[e._v("\n                标题："+e._s(n.title)+"\n            ")]):e._e()])})),0):e._e(),t("nya-container",{attrs:{title:"说明"}},[t("ul",{staticClass:"nya-list"},[t("li",[e._v("若图片上传失败，可联系微信：lovesnad 或邮箱 imiku.me@gmail.com 发送图片原图给站长反馈")]),t("li",[t("b",[e._v("暂时只支持 ACG 图片搜索")])]),t("li",[t("b",[e._v("请善于使用 "),t("nuxt-link",{attrs:{to:"/picture_clipping"}},[e._v("图片裁剪")]),e._v(" 更高效率的识别图片")],1)]),t("li",[e._v("识别成功率取决于上传的图片")]),t("li",[e._v("多个相同/类似结果是因为返回的数据包含多个相同/类似结果，推荐使用 Pixiv 的数据")])])])],1)}),[],!1,null,null,null);"function"==typeof d&&d(component);t.default=component.exports},959:function(e,t,n){"use strict";n(13);t.a=function(e){return new Promise((function(t,n){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){return t(o.result)},o.onerror=function(e){return n(e)}}))}}}]);